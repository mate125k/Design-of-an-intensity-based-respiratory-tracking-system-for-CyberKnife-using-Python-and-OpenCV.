
import pandas as pd
import numpy as np
from scipy.signal import find_peaks
import matplotlib.pyplot as plt

# Parsing the input data manually (since it's provided directly in the message).
# Creating a DataFrame from the provided values, assuming the format is "SpO2, PULSE".

data_values = [
    (98, 169), (98, 169), (99, 141), (99, 141), (99, 106), (99, 106), (99, 106), (99, 106),
    (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106),
    (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106),
    (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106),
    (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106), (99, 106),
    (99, 106), (99, 106), (99, 106), (99, 94), (99, 94), (99, 94), (99, 94), (99, 94),
    (99, 94), (99, 94), (99, 94), (99, 94), (99, 94), (99, 94), (99, 94), (99, 94), (99, 93),
    (99, 93), (99, 93), (99, 93), (98, 94), (98, 94), (98, 94), (98, 94), (98, 94), (98, 94),
    (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 93),
    (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 93),
    (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 93), (98, 97), (98, 101),
    (98, 101), (98, 101), (98, 101), (98, 101), (98, 101), (98, 102), (98, 106), (98, 106),
    (98, 106), (98, 106), (98, 106), (98, 106), (98, 106), (98, 107), (98, 107), (98, 107),
    (98, 109), (98, 109), (98, 109), (98, 109), (98, 109), (98, 109), (98, 109), (98, 110),
    (98, 110), (98, 110), (98, 110), (98, 110), (98, 110), (98, 110), (98, 110), (98, 106),
    (98, 106), (98, 106), (98, 102), (98, 97), (98, 97), (98, 97), (98, 97), (98, 97),
    (98, 97), (99, 96), (99, 95), (98, 95), (98, 93), (98, 93), (98, 94), (98, 96), (98, 97),
    (98, 97), (98, 97), (98, 97), (98, 97), (98, 97), (98, 97), (98, 96), (98, 97), (98, 98),
    (98, 98), (98, 98), (98, 98), (98, 97), (98, 94), (98, 94), (98, 92), (98, 92), (98, 91),
    (98, 90), (98, 90), (98, 89), (98, 89), (98, 88), (98, 87), (98, 87), (98, 87), (98, 88),
    (98, 88), (98, 88), (98, 88), (98, 88), (98, 88), (98, 89), (98, 88), (98, 88), (98, 88),
    (98, 89), (98, 90), (98, 90), (98, 91), (98, 91), (98, 91), (98, 90), (98, 90), (98, 90),
    (98, 90), (98, 90), (98, 90), (98, 90), (98, 90), (98, 91), (98, 91), (98, 93), (98, 96),
    (98, 96), (98, 96), (98, 96), (98, 96), (98, 96), (98, 96), (98, 96), (98, 96), (98, 96),
    (98, 96), (98, 97), (98, 99), (98, 100), (97, 101), (98, 101), (98, 100), (98, 100),
    (98, 100), (98, 100), (98, 100), (98, 99), (98, 96), (98, 96), (98, 96), (98, 96),
    (98, 96), (98, 96), (98, 96), (98, 96), (98, 96), (98, 96), (98, 96), (98, 95), (98, 94),
    (98, 93), (98, 93), (98, 91), (98, 89), (98, 87), (98, 87), (98, 87), (98, 87), (98, 87),
    (98, 87), (98, 85), (97, 85), (97, 84), (97, 85), (98, 87), (98, 89), (98, 90), (98, 90),
    (98, 90), (98, 91), (98, 92), (98, 93), (98, 94), (98, 94), (98, 95), (98, 95), (98, 95),
    (98, 95), (98, 94), (98, 94), (98, 94), (98, 94), (98, 95), (98, 96), (98, 97), (98, 97),
    (98, 96), (98, 96), (98, 96), (98, 96), (98, 97), (98, 97), (98, 97), (98, 97), (98, 97),
    (98, 97)
]

# Create a DataFrame
df = pd.DataFrame(data_values, columns=["SpO2", "PULSE"])

# Analyzing the PULSE data to detect respiratory patterns
pulse_signal = df["PULSE"]

# Detecting peaks in the PULSE signal to estimate respiratory cycles
peaks, _ = find_peaks(pulse_signal, distance=10)  # Using a minimum distance of 10 samples

# Calculating the estimated respiratory rate based on detected peaks
num_peaks = len(peaks)
duration_minutes = 0.47  # Given data duration is 1 minute
respiratory_rate = num_peaks / duration_minutes

respiratory_rate, num_peaks
print('Respiratory rate:',respiratory_rate)